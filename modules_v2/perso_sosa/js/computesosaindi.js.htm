<?php
/**
 * Javascript to include before the Sosa module menu to compute Sosas from an individual
 *
 * @package webtrees
 * @subpackage Perso
 * @author: Jonathan Jaubart ($Author$)
 * @version: p_$Revision$ $Date$
 * $HeadURL$
 */

if (!defined('WT_WEBTREES')) {
	header('HTTP/1.0 403 Forbidden');
	exit;
}

global $WT_IMAGES;

?>

<script type='text/javascript'>
	//<![CDATA[		           
       	jQuery(document).ready(function() {
      	   $('#loadingarea').empty().html('<img src="<?php echo $WT_IMAGES['loading']; ?>" alt="<?php echo htmlspecialchars(WT_I18N::translate('Loading...')); ?>" />');
      	   $('#loadingarea').load('module.php?mod=perso_sosa&mod_action=computesosaindi&pid=<?php echo $pid; ?>', 
      			function(){
		      		 var date = new Date();
		      		 var curDate = null;
		      		 
		      		do { curDate = new Date(); } 
		      		while(curDate-date < 2000);

      		 		window.opener.location='individual.php?pid=<?php echo $pid; ?>&show_changes=yes';
      		 		window.close();
      	   		}	   
      	   );
         });
	//]]
</script>